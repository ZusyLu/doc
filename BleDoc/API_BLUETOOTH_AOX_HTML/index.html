<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Silicon Labs Real-Time Locationing Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Silicon Labs Real-Time Locationing Library
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is the API for the Silicon Labs Real-Time Locationing library. It provides an interface for estimating arrival and departure angles of signals and the positions of AoA/AoD signal transmitters. AoA stands for Angle-of-Arrival and AoD for Angle-of-Departure. AoX is used here when referring to both techniques.</p>
<p>Estimators can be created individually for each locator node using the API. Additionally, multiple estimators with different parameters can be created for a single node. An instance of the estimator is created as a libitem and the estimator is initialized. Next, the estimation parameters such as antenna array type, number of antennas, estimation mode, and so on can be set using the function calls described below.</p>
<p>One snapshot is a set of IQ-samples with exactly one sample for each antenna.</p>
<h2>Software Example</h2>
<p>Example: Initialize an estimator, set up parameters, create the estimator, and calculate an angle estimate from previously captured I/Q samples. Finally, deinitialize the estimator after returning the angles.</p>
<div class="fragment"><div class="line"><span class="comment">// Estimator instance</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga0084a6581f9c7e03f6bdcc23d4d710c1">sl_rtl_aox_libitem</a> libitem1;</div><div class="line"></div><div class="line"><span class="comment">// Initialize the estimator</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga27668f657208e6cb73005c2079153776">sl_rtl_aox_init</a>(&amp;libitem1);</div><div class="line"></div><div class="line"><span class="comment">// Set number of snapshots to 3</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga5617794722f2698d991cee04a2e2eed7">sl_rtl_aox_set_num_snapshots</a>(&amp;libitem1, 3);</div><div class="line"></div><div class="line"><span class="comment">// Set array type to SiLabs reference 4x4 Uniform Rectangular Array</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga3254bada0ba586a4d95bf72798c3906c">sl_rtl_aox_set_array_type</a>(&amp;libitem1, <a class="code" href="group__sl__rtl__aox.html#gga829c9154cb92b43c90661b60b5df88b5ac3bbd34c4f45e079dcd001de6e622545">SL_RTL_AOX_ARRAY_TYPE_4x4_URA</a>);</div><div class="line"></div><div class="line"><span class="comment">// Set estimator mode to basic mode, which requires 10 estimation rounds</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#gaa17924310c76c05b1df7c96f16cb4874">sl_rtl_aox_set_mode</a>(&amp;libitem1, SL_RTL_AOX_MODE_BASIC);</div><div class="line"></div><div class="line"><span class="comment">// Enable IQ sample quality analysis processing (optional)</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga56c80a8407c4708413c0013ef7d5ef02">sl_rtl_aox_iq_sample_qa_configure</a>(&amp;libitem1);</div><div class="line"></div><div class="line"><span class="comment">// Create the estimator after all of the parameters are set</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga6b6ceee7cae56f2e90c2134e425799db">sl_rtl_aox_create_estimator</a>(&amp;libitem1);</div><div class="line"></div><div class="line"><span class="comment">// Set library switch pattern mode and the pattern itself</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#gaa2be2dbb47912c98f7b21620373ac22a">sl_rtl_aox_set_switch_pattern_mode</a>(&amp;libitem1, <a class="code" href="group__sl__rtl__aox.html#gga5c0ba6c84f2dda357f2b250a0b6abcbda87eeb85b4895542a075a4317e0fcb808">SL_RTL_AOX_SWITCH_PATTERN_MODE_EXTERNAL</a>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> uint32_t number_of_channels = 4*4;</div><div class="line">uint32_t switch_pattern[number_of_channels] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15};</div><div class="line"><a class="code" href="group__sl__rtl__aox.html#gacbc6c31c7d7c051c929faae8aaa4936e">sl_rtl_aox_update_switch_pattern</a>(&amp;libitem1, switch_pattern, 0);</div><div class="line"></div><div class="line"><span class="comment">// Configure radio with the same switching pattern</span></div><div class="line">radioConfigureSwitchPattern(switch_pattern, number_of_channels); <span class="comment">// Dummy function</span></div><div class="line"></div><div class="line"><span class="comment">// Setup variables</span></div><div class="line"><span class="keywordtype">float</span> azimuthOut, elevationOut;</div><div class="line"><span class="keywordtype">float</span> channelFrequency = 2.46e9f;</div><div class="line"></div><div class="line"><span class="keywordtype">float</span> *IReference, *QReference;</div><div class="line"><span class="keywordtype">float</span> **ISamples, **QSamples;</div><div class="line"><span class="comment">// Allocate buffers for reference period I/Q data, size 8 samples</span></div><div class="line">allocate1DFloatBuffer(&amp;IReference, 8); <span class="comment">// Dummy function</span></div><div class="line">allocate1DFloatBuffer(&amp;QReference, 8); <span class="comment">// Dummy function</span></div><div class="line"></div><div class="line"><span class="comment">// Allocate buffers for I/Q data from all antennas, size 3 snapshots x 16 antennas</span></div><div class="line">allocate2DFloatBuffer(&amp;ISamples, 3, 16); <span class="comment">// Dummy function</span></div><div class="line">allocate2DFloatBuffer(&amp;QSamples, 3, 16); <span class="comment">// Dummy function</span></div><div class="line"></div><div class="line"><a class="code" href="group__sl__rtl__error.html#ga258699077faf3ac6fdf3a2eb68502494">sl_rtl_error_code</a> result = <a class="code" href="group__sl__rtl__error.html#gga258699077faf3ac6fdf3a2eb68502494ac38a542f04d23de82e2f7f9092c88e97">SL_RTL_ERROR_ESTIMATION_IN_PROGRESS</a>;</div><div class="line"></div><div class="line"><span class="keywordflow">while</span> (result != <a class="code" href="group__sl__rtl__error.html#gga258699077faf3ac6fdf3a2eb68502494ab455912593ede2d45ee471f49b9ed41d">SL_RTL_ERROR_SUCCESS</a>) {</div><div class="line">  <span class="comment">// Wait for new I/Q samples from radio</span></div><div class="line">  waitForNewIqSampleReport(); <span class="comment">// Dummy function</span></div><div class="line"></div><div class="line">  <span class="keywordtype">int</span> index = 0;</div><div class="line">  <span class="comment">// Get captured I/Q reference period samples from radio (example)</span></div><div class="line">  <span class="keywordflow">for</span> (uint32_t sample = 0; sample &lt; 8; ++sample) {</div><div class="line">      IReference[sample] = iq_report.samples.data[index]; <span class="comment">// Dummy data</span></div><div class="line">      QReference[sample] = iq_report.samples.data[index + 1]; <span class="comment">// Dummy data</span></div><div class="line">      index += 2;</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Calculate and set phase rotation to compensate for frequency offset and switching</span></div><div class="line">  <span class="keywordtype">float</span> phaseRotation;</div><div class="line">  <a class="code" href="group__sl__rtl__aox.html#gaa4053d7c6a11abe2d8e124539bfd5b46">sl_rtl_aox_calculate_iq_sample_phase_rotation</a>(&amp;libitem1, 2.0f, IReference, QReference, 8, &amp;phaseRotation);</div><div class="line">  <a class="code" href="group__sl__rtl__aox.html#ga8946c9bf46cd31cee04ee1d3709d2d44">sl_rtl_aox_set_iq_sample_phase_rotation</a>(&amp;libitem, phaseRotation);</div><div class="line"></div><div class="line">  <span class="comment">// Get captured I/Q samples from all antennas from radio (example)</span></div><div class="line">  <span class="keywordtype">int</span> index = 14;</div><div class="line">  <span class="keywordflow">for</span> (uint32_t snapshot = 0; snapshot &lt; 3; ++snapshot) {</div><div class="line">    <span class="keywordflow">for</span> (uint32_t antenna = 0; antenna &lt; 16; ++antenna) {</div><div class="line">      ISamples[snapshot][antenna] = iq_report.samples.data[index]; <span class="comment">// Dummy data</span></div><div class="line">      QSamples[snapshot][antenna] = iq_report.samples.data[index + 1]; <span class="comment">// Dummy data</span></div><div class="line">      index += 2;</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Feed I/Q data to estimator and calculate estimates</span></div><div class="line">  result = <a class="code" href="group__sl__rtl__aox.html#ga178b1682b76125cfc11cb065819b129e">sl_rtl_aox_process</a>(&amp;libitem1, ISamples, QSamples,</div><div class="line">    channelFrequency, &amp;azimuthOut, &amp;elevationOut);</div><div class="line">}</div><div class="line"></div><div class="line">*returnAzimuth = azimuthOut;</div><div class="line">*returnElevation = elevationOut;</div><div class="line"></div><div class="line"><span class="comment">// get the overall result of the IQ sample quality results</span></div><div class="line">uint32_t sample_qa_results = sl_rtl_aox_get_iq_sample_qa_results(&amp;libitem1);</div><div class="line"></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#structsl__rtl__clib__iq__sample__qa__dataset__t">sl_rtl_clib_iq_sample_qa_dataset_t</a> quality_results;</div><div class="line"><a class="code" href="group__sl__rtl__aox.html#structsl__rtl__clib__iq__sample__qa__antenna__data__t">sl_rtl_clib_iq_sample_qa_antenna_data_t</a> antenna_data[numAntennas];</div><div class="line"></div><div class="line"><span class="comment">// get the IQ sample quality results for the latest packet</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga3d6c82f59d9af38592fba3ac68ec0aea">sl_rtl_aox_iq_sample_qa_get_details</a>(&amp;libitem1, &amp;quality_results, antenna_data);</div><div class="line"></div><div class="line"><span class="comment">// get the IQ sample quality results for the latest packet using the certain radio channel</span></div><div class="line"><span class="comment">// (which is not necessarily the latest packet received)</span></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga43fcbd2785311178afcca6ae009417e0">sl_rtl_aox_iq_sample_qa_get_channel_details</a>(&amp;libitem1, bt_channel, &amp;quality_results, antenna_data);</div><div class="line"></div><div class="line"><a class="code" href="group__sl__rtl__aox.html#ga21ab2338db378a7f5c7db18278d804ec">sl_rtl_aox_deinit</a>(&amp;libitem1);</div></div><!-- fragment --><h2>License</h2>
<p>Copyright 2019-2020 Silicon Laboratories Inc. www.silabs.com</p>
<p>The licensor of this software is Silicon Laboratories Inc. Your use of this software is governed by the terms of Silicon Labs Master Software License Agreement (MSLA) available at www.silabs.com/about-us/legal/master-software-license-agreement. This software is distributed to you in Source Code format and is governed by the sections of the MSLA applicable to Source Code.</p>
<p>Information on open-source software used with the library can be found in the included license.txt file. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
