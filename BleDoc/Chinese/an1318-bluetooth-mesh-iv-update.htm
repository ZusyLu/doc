<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>AN1318: IV Update Functionality</title><meta name="author" content="Silicon Labs"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 24pt; }
 .s2 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s3 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s4 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s5 { color: #007693; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h4 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 .p, p { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s6 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .a, a { color: #00F; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 9pt; }
 .s7 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s8 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s9 { color: #049; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s10 { color: #049; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s11 { color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s13 { color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s14 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 h2 { color: #FFF; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 20pt; }
 .s16 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s17 { color: #4C4D4F; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s18 { color: #424242; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s19 { color: #424242; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s20 { color: #4C4D4F; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s21 { color: #4C4D4F; font-family:"Arial Black", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s23 { color: #4C4D4F; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s25 { color: #0086DD; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s26 { color: #4C4D4F; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 4pt; vertical-align: 2pt; }
 h3 { color: #FB1725; font-family:"Lucida Sans", sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: " "; color: black; font-family:Symbol, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt; }
 #l3> li>*:first-child:before {content: " "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l4 {padding-left: 0pt;counter-reset: d2 1; }
 #l4> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l5 {padding-left: 0pt; }
 #l5> li>*:first-child:before {content: " "; color: black; font-family:Symbol, serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l6 {padding-left: 0pt;counter-reset: d2 1; }
 #l6> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l7 {padding-left: 0pt; }
 #l7> li>*:first-child:before {content: " "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l8 {padding-left: 0pt; }
 #l8> li>*:first-child:before {content: " "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l9 {padding-left: 0pt;counter-reset: f1 1; }
 #l9> li>*:first-child:before {counter-increment: f1; content: counter(f1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l9> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l10 {padding-left: 0pt;counter-reset: f2 1; }
 #l10> li>*:first-child:before {counter-increment: f2; content: counter(f2, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l10> li:first-child>*:first-child:before {counter-increment: f2 0;  }
 #l11 {padding-left: 0pt;counter-reset: f3 1; }
 #l11> li>*:first-child:before {counter-increment: f3; content: counter(f3, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: f3 0;  }
 #l12 {padding-left: 0pt; }
 #l12> li>*:first-child:before {content: " "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l13 {padding-left: 0pt;counter-reset: d2 1; }
 #l13> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l14 {padding-left: 0pt;counter-reset: d2 2; }
 #l14> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l14> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l15 {padding-left: 0pt;counter-reset: d2 3; }
 #l15> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l15> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l16 {padding-left: 0pt;counter-reset: d2 4; }
 #l16> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l16> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 #l17 {padding-left: 0pt;counter-reset: d2 5; }
 #l17> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l17> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 li {display: block; }
 #l18 {padding-left: 0pt; }
 #l18> li>*:first-child:before {content: " "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><span><img width="127" height="62" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_001.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="37" height="37" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_002.png"/></span></p><h1 style="padding-top: 11pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">AN1318: IV Update in a <i>Bluetooth® </i>Mesh Network</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 21pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="728" height="1" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_003.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="206" height="1" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_004.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s2" style="padding-top: 4pt;padding-bottom: 1pt;padding-left: 12pt;text-indent: 0pt;text-align: left;">KEY POINTS</p><p style="padding-left: 11pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="208" height="1" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_005.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l1"><li><p class="s3" style="padding-left: 20pt;text-indent: -7pt;text-align: left;">Short introduction to Bluetooth mesh security and replay attacks</p></li><li><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -7pt;text-align: left;">Sequence number and IV index</p></li><li><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -7pt;text-align: left;">IV Update procedure</p></li><li><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -7pt;text-align: left;">IV Index Recovery procedure</p></li><li><p class="s3" style="padding-top: 3pt;padding-left: 20pt;text-indent: -7pt;text-align: left;">Bluetooth mesh APIs for IV update and recovery</p></li></ul><p style="text-indent: 0pt;text-align: left;"/><p class="s4" style="padding-top: 4pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">This application note provides background information on the sequence number and IV index in a Bluetooth mesh network and the IV Update and IV Index Recovery procedures. It then discusses how to implement IV Update functionality in a Bluetooth mesh application.</p><p class="s5" style="padding-bottom: 2pt;text-indent: 0pt;text-align: right;">Introduction</p><p style="padding-left: 21pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="724" height="1" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_006.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l2"><li><h4 style="padding-left: 40pt;text-indent: -18pt;text-align: left;"><a name="bookmark0">Introduction</a></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">Security is mandatory in Bluetooth mesh and cannot be switched off or reduced in any way. The network security, application security, and device security are all addressed independently. Security in Bluetooth mesh networking protects against various threats and is- sues, including:</p><ul id="l3"><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Replay attacks, which are prevented by judicious use of sequence numbers.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Man-in-the-middle attacks, which are protected against by using asymmetrical cryptography, such as the Elliptic Curve Diffie- Hellman (ECDH) key agreement protocol, during provisioning of a new device into the network.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Trash-can attacks, which exploit discarded devices, by ensuring security keys get refreshed when necessary.</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">A replay attack is a technique whereby an eavesdropper intercepts and captures one or more messages and simply retransmits them later, with the goal of tricking the recipient into carrying out something which the attacking device is not authorized to do. An example, commonly cited, is that of a car’s keyless entry system being compromised by an attacker, intercepting the authentication sequence between the car’s owner and the car, and later replaying those messages to gain entry to the car and steal it.</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">Bluetooth mesh has protection against replay attacks. The basis for this protection is the use of two cryptographic values in the mesh network called the Sequence Number (SEQ) and IV Index, respectively. Nodes keep track of the sequence numbers in the messages they receive, and together with the IV index of the network can detect and discard replayed messages.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l4"><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark1">Prerequisites</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">You should have:</p></li></ol></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">A general understanding of Bluetooth mesh concepts such as nodes and elements.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Installed and be familiar with using the following:</p><ul id="l5"><li><p style="padding-top: 3pt;padding-left: 51pt;text-indent: -14pt;text-align: left;">Simplicity Studio v5.0.0 or above</p></li><li><p style="padding-top: 3pt;padding-left: 51pt;text-indent: -14pt;text-align: left;">Bluetooth Mesh SDK v2.0.0 or above</p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">If you need to familiarize yourself with any of these concepts, the following may be useful:</p></li></ul></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;"><a href="https://www.bluetooth.com/wp-content/uploads/2019/03/Mesh-Technology-Overview.pdf" class="a" target="_blank">Bluetooth Mesh Networking - An Introduction for </a><a href="https://www.bluetooth.com/wp-content/uploads/2019/03/Mesh-Technology-Overview.pdf" target="_blank">Developers</a></p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;"><a href="https://www.silabs.com/documents/public/quick-start-guides/qsg176-bluetooth-mesh-sdk-v2x-quick-start-guide.pdf" class="a" target="_blank">QSG176: Bluetooth® Mesh SDK v2.x Quick-Start </a><a href="https://www.silabs.com/documents/public/quick-start-guides/qsg176-bluetooth-mesh-sdk-v2x-quick-start-guide.pdf" target="_blank">Guide</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><h4 style="padding-top: 4pt;padding-left: 40pt;text-indent: -18pt;text-align: left;"><a name="bookmark2">Sequence Number and IV Index</a></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">A Nonce is a number which may only be used once. Each time a message is encrypted, it is given a new nonce value. The nonce has various parts to it, including a sequence number and a value known as the IV Index. To ensure nonce values are unique for each new message encryption, the sequence number inside a nonce must not be allowed to wrap around while IV index remains unchanged.</p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The sequence number is a 24-bit value that allows an element to transmit 16,777,216 messages before repeating a nonce. If an ele- ment transmits a message on average once every second, then these sequence numbers would be exhausted after 194 days. To ena- ble a mesh network to operate for longer periods of time than the sequence number space allows, an additional 4-octet value called the IV (Initialization Vector) Index is defined that is included in the security nonce.</p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;line-height: 106%;text-align: justify;">The IV Index is a 32-bit value that is a shared network resource (that is, all nodes in a mesh network share the same IV Index value and use it for all subnets they belong to). Its purpose is to provide entropy (randomness) in the calculation of message Nonce values. At the same frequency of one message every second, the lifetime of the network using the IV Index would measure in billions of years.</p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Read Sections 3.8.3 and 3.8.4 of the Bluetooth Mesh Profile Specification v1.0.1 for further information.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Before the sequence number approaches the maximum value (0xFFFFFF), the element updates the IV Index using the IV Update pro- cedure. The IV Index starts at 0x00000000 and is incremented during the IV Update procedure.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l6"><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark3">Sequence Number Increments</a><a name="bookmark7">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Each element increases the sequence number by one for every Network Protocol Data Unit (PDU) sent out to the network. The se- quence number must be stored in non-volatile memory to ensure the sequence numbers that have been used will not be reused. How- ever, writing every sequence number increment to flash memory is likely too many writes and would probably wear out flash memory during the lifetime of a product. The solution for this issue depends on Bluetooth mesh stack implementations.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">In our implementation, the stack stores the sequence number in flash memory at a fixed interval when the sequence number is a multi- ple of a configurable value. Given that a device may lose power unexpectedly during the interval, the stored sequence number may be behind the sequence number actually used last, and using the stored value directly would lead to sequence number reuse. To avoid using the sequence numbers that have been used, the stack increases the stored sequence number by the configured interval value on a reset. The stack won’t increase the sequence number if the increment of the stored sequence number was 0.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The stack will not transmit any Network PDUs from an element if its sequence number has reached the max value 0xFFFFFF. A node should initiate the IV Update procedure whenever it determines it is at risk of exhausting its sequence number values within a maximum of 96 hours, or if it determines that another node is in this situation.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark4">IV Update Procedure</a><a name="bookmark8">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The IV Update procedure should be performed before the sequence number is exhausted. The procedure updates the IV index to a new value that will be used for subsequent communication in the mesh network. Once the IV Update procedure completes, the se- quence number is reset to 0 on every element of every node in the network.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The IV Update procedure is initiated by any node in a primary subnet. If a node on a primary subnet receives an update on the primary subnet, it propagates the IV update to all other subnets. If a node on a primary subnet receives an IV update on any other subnet, the update is ignored.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The IV Index is shared within a mesh network via Secure Network beacons. IV updates received on a subnet are processed and prop- agated to that subnet. The propagation happens by the node transmitting Secure Network beacons with the updated IV Index for that particular subnet. A node that receives an IV update may or may not be able to update its IV index depending on the IV Update proce- dure state and the time since the last IV update.</p><ul id="l7"><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">When a node is added to a mesh network, it is in the Normal Operation state. During the Normal Operation state, the IV Update Flag in the Secure Network beacon and in the Friend Update message is set to 0.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">After 96 hours of operating in the Normal Operation state, a node may initiate the IV Update procedure by transitioning to the IV Update in Progress state. When a node transitions from the Normal Operation state to the IV Update in Progress state, the IV Index on the node is incremented by one.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">During the IV Update in Progress state, the IV Update Flag in the Secure Network beacon and in the Friend Update message is set to 1.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">A node in the Normal Operation state receives a Secure Network beacon with the IV Update Flag set to 1 and an IV index equal to its current IV index + 1. The node then transitions to the IV Update in Progress state and updates its current IV index.</p></li><li><p style="padding-top: 7pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">After at least 96 hours and before 144 hours of operating in the IV Update in Progress state, the node transitions back to the Normal Operation state and resets its sequence number to 0x000000.</p></li><li><p style="padding-top: 3pt;padding-left: 22pt;text-indent: 0pt;line-height: 173%;text-align: justify;">A node must not start an IV Update procedure more often than once every 192 hours. Read Section 3.10.5 of the Bluetooth Mesh Profile Specification v1.0.1 for further information.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: justify;"><a name="bookmark5">IV Index Recovery Procedure</a><a name="bookmark9">&zwnj;</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">If a node is absent from a mesh network for a period of time, it may have missed IV index updates and is not able to communicate with other nodes. In this case, the node can scan for a Secure Network beacon, which contains the Network ID and the current IV Index, to recover the IV index. The IV Index Recovery procedure sets the current IV index and the IV Update procedure state of a node from the values in the Secure Network beacon.</p><ul id="l8"><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">A node in the Normal Operation state receives a Secure Network beacon with an IV index greater than its current IV index + 1. It then may initiate an IV Index Recovery procedure.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">A node in the Normal Operation state receives a Secure Network beacon with the IV Update Flag set to 0 and an IV index equal to its current IV index + 1. It then may update its IV index without going to the IV Update in Progress state, or it may initiate an IV Index Recovery procedure, or it may ignore the Secure Network beacon. The node makes the choice depending on the time since the last IV update.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">After the IV Index Recovery procedure has updated the IV Index, the 96-hour time limits for changing the IV Update procedure state, as defined in the IV Update procedure, do not apply.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">A node must not execute more than one IV Index Recovery procedure within a period of 192 hours.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: justify;">A node in the Normal Operation state receives a Secure Network beacon with an IV index less than its current IV index or greater than its current IV index + 42. It ignores the Secure Network beacon. This allows a node to be away from the mesh network for 48 weeks. A node that is away from a network for longer than 48 weeks must be reprovisioned.</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">Read Section 3.10.6 of the Bluetooth Mesh Profile Specification v1.0.1 for further information.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: justify;"><a name="bookmark6">IV Update Procedure Example</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">A summary of the IV Update procedure is provided in the table below.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:16.05pt" cellspacing="0"><tr style="height:25pt"><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#808080"><p class="s7" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">IV Index</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#808080"><p class="s7" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">IV Update Flag</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#808080"><p class="s7" style="padding-top: 1pt;padding-left: 5pt;padding-right: 15pt;text-indent: 0pt;text-align: left;">IV Update Procedure State</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#808080"><p class="s7" style="padding-top: 7pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">IV Index Accepted</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#808080"><p class="s7" style="padding-top: 1pt;padding-left: 5pt;padding-right: 20pt;text-indent: 0pt;text-align: left;">IV Index used when transmitting</p></td></tr><tr style="height:15pt"><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">n</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Normal</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">n-1, n</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">n</p></td></tr><tr style="height:15pt"><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m (m=n+1)</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">1</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">In Progress</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m-1, m</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m-1</p></td></tr><tr style="height:15pt"><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Normal</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m-1, m</p></td><td style="width:111pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">m</p></td></tr></table><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The following example illustrates the transition of the IV Update procedure state and IV index updates in the IV Update procedure. It will help explain the table above. You will also see from this example that the nodes before, during and after the IV Update procedure are able to communicate based on their Tx and Rx IV indices.</p><ol id="l9"><li><p style="padding-top: 3pt;padding-left: 40pt;text-indent: -18pt;text-align: justify;">Node A and B are in the Normal Operation state and have the IV index 80 (n = 80, IV Update Flag = 0).</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 37pt;text-indent: 0pt;text-align: left;"><span><img width="667" height="63" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_007.gif"/></span></p></li><li><p style="padding-top: 7pt;padding-left: 41pt;text-indent: -18pt;text-align: left;">Node A initiates the IV Update procedure and then Node B performs the IV Update procedure (m = 81, IV Update Flag = 1).</p><ol id="l10"><li><p style="padding-top: 3pt;padding-left: 51pt;text-indent: -14pt;text-align: left;">Node A transitions to the IV Update in Progress state and increments its IV index by 1.</p></li><li><p style="padding-top: 3pt;padding-left: 51pt;text-indent: -14pt;text-align: left;">Node B receives a Secure Network beacon with IV index = 81 and IV Update Flag = 1, transitions to the IV Update in Progress state and increments its IV index by 1.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 50pt;text-indent: 0pt;text-align: left;"><span><img width="652" height="103" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_008.gif"/></span></p></li><li><p style="padding-top: 7pt;padding-left: 40pt;text-indent: -18pt;text-align: left;">Node A and B transition to the Normal Operation state (m = 81, IV Update Flag = 0).</p><ol id="l11"><li><p style="padding-top: 3pt;padding-left: 58pt;text-indent: -18pt;text-align: left;">Node A transitions to the Normal Operation state.</p></li><li><p style="padding-top: 3pt;padding-left: 58pt;text-indent: -18pt;text-align: left;">Node B receives a Secure Network beacon with IV index = 81 and IV Update Flag = 0 and transitions to the Normal Operation state.</p></li></ol></li></ol></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 55pt;text-indent: 0pt;text-align: left;"><span><img width="616" height="97" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_009.gif"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li><h4 style="padding-top: 4pt;padding-left: 40pt;text-indent: -18pt;text-align: left;"><a name="bookmark10">IV Update Functionality Implementation</a></h4><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 22pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark8" class="s14">The IV Update procedure described in Section </a><a href="#bookmark8" class="s9">2.2 </a>IV Update Procedure <a href="#bookmark9" class="s14">and the IV Index Recovery procedure described in Section </a><a href="#bookmark9" class="s9">2.3 </a>IV Index Recovery Procedure <span style=" color: #000;">have been implemented in the Bluetooth mesh stack. However, the stack cannot determine how long the remaining sequence numbers might last. The application should determine when a node may run out of sequence numbers and should initiate the IV Update procedure before sequence numbers are exhausted. If a node is absent from a mesh network for a period of time, the application should enable IV index recovery mode to set the IV Index value autonomously.</span></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">Secure network beacons are used to carry required information and are transmitted in the primary network. The nodes in the primary network that need to request IV index updates must enable secure network beacon broadcasting. This is usually configured by the provisioner. Note that some Bluetooth mesh mobile applications may not support configuration of the secure network beacon state. The application can call the <span class="s11">sl_btmesh_test_set_local_config() </span>API to set the state locally.</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">The following is a summary of the items that should be included in your system to implement IV Update functionality properly:</p><ul id="l12"><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Secure network beacons enabled on nodes.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Code to track time across resets and set the time since the last IV update at booting.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Code to determine sequence number exhaustion and trigger an IV index update.</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Code to check the network IV index and handle IV index recovery mode.</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">See the <i>Silicon Labs Bluetooth Mesh API Reference Manual </i>for all the BGAPI information.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l13"><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark11">Tracking Time Across Resets</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;line-height: 106%;text-align: justify;">The stack uses a timer to calculate the duration required to execute an IV Update or IV Index Recovery procedure. The timer is main- tained in RAM and is reset whenever the device resets. This may cause an IV Update or IV Index Recovery procedure to execute later than expected. IV updates would not occur if frequent resets or power cycles are encountered in the application.</p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The application should track time across resets or power cycles. This is usually done by storing the time in flash memory regularly. The application then should call the following API to set the timer in the stack.</p></li></ol></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_set_iv_update_age()</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The stack generates the following event when the IV Update procedure state has changed. If you did not call the <span class="s13">sl_btmesh_test_set_ivupdate_state() </span>API to change the state forcefully, this event indicates the IV Update procedure is on- going (the value of the state is 1) or an IV update has completed (the value of the state is 0). The timer in the stack is reset to 0 when an IV update completes. The application should synchronize the time with the timer on this event when the value of the state is 0.</p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_evt_node_changed_ivupdate_state_id</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l14"><li><p class="s6" style="padding-top: 9pt;padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark12">Determining Sequence Number Exhaustion</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;"><a href="#bookmark7" class="s14">As described in Section </a><a href="#bookmark7" class="s9">2.1 Sequence Number Increments</a>, the stack uses an interval value to determine sequence number storing and to add to the stored sequence number on a reset. The interval value can be configured by the structure member <span class="s11">pstore_write_interval_elem_seq </span>of the<u> </u><span class="s11">mesh_memory_config </span>variable in <i>sl_btmesh_dcd.c</i>. The value of this setting must be a power of 2. You may decrease the value if the device resets or power cycles regularly.</p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Every element of a node keeps a sequence number counter. The application should call the following APIs to get the number of remain- ing sequence numbers or the current sequence number of an element.</p></li></ol></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_get_seq_remaining()</p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_get_element_seqnum()</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The maximum value of the sequence number is 0xFFFFFF. The application should know how often messages are transmitted to the network and therefore be able to determine if any element is about to exhaust its available sequence numbers. The application then should request the stack to initiate the IV Update procedure. The application must ensure the available sequence numbers can run for at least 96 hours when initiating the IV Update procedure. This time period can be extended to a safe period due to regular device re- sets or irregularity of message transmission.</p><ol id="l15"><li><p class="s6" style="padding-top: 7pt;padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark13">Initiating IV Update</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">The application should call the following API to request the stack to initiate the IV Update procedure.</p></li></ol></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_request_ivupdate()</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The <span class="s11">sl_btmesh_evt_node_changed_ivupdate_state_id </span>event is generated when the IV Update procedure has started or completed. The application can use this event to monitor the IV Update procedure state and the current IV index.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l16"><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark14">Recovering IV Index</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: left;">The application should call the following API to enable the IV index recovery mode.</p></li></ol></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_set_ivrecovery_mode()</p><p style="padding-top: 8pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The IV index recovery mode should be enabled when the node may have missed IV index updates and need to perform the IV Index Recovery procedure. In this case, the following event is generated. The application should check the received network IV index and the current IV index that come with the event and enable the IV index recovery mode only when the received network IV index is greater than the current IV index and is equal to or less than the current IV index + 42.</p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_evt_node_ivrecovery_needed_id</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;line-height: 107%;text-align: justify;">If a real time clock is available in the device, the application can also check the IV index increment with the time elapsed. The time since the last IV update should be greater than the IV index increment multiplied by 192 hours minus 96 hours.</p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;text-align: justify;">The <span class="s11">sl_btmesh_evt_node_changed_ivupdate_state_id </span>event is generated when the IV Index Recovery procedure has completed. The application should disable the IV index recovery mode on this event.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l17"><li><p class="s6" style="padding-left: 51pt;text-indent: -28pt;text-align: left;"><a name="bookmark15">IV Update Testing</a></p><p style="padding-top: 7pt;padding-left: 22pt;text-indent: 0pt;line-height: 107%;text-align: justify;">There are time limits on the IV Update and IV Index Recovery procedures so testing on Bluetooth mesh applications would be ineffi- cient. The IV Update test mode removes these time limits. The application can call the following API to enable the IV Update test mode.</p></li></ol></li><li><p class="s11" style="padding-top: 2pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_test_set_ivupdate_test_mode()</p><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">The following APIs may be useful when testing the IV Update functionality.</p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_test_set_ivupdate_state()<span class="p">– forces the node to transition to the IV Update in Progress state or to the Normal Operation state.</span></p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_test_set_iv_index()<span class="p">– changes the node&#39;s current IV index to any value.</span></p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_test_set_local_config() <span class="p">– changes a state of the Configuration Server model in the node. With the</span></p><p class="s11" style="padding-left: 37pt;text-indent: 0pt;text-align: left;">sl_btmesh_node_beacon <span class="p">parameter, enables or disables Secure Network Beacons broadcasting.</span></p></li><li><p class="s11" style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">sl_btmesh_node_set_beacon_reporting()<span class="p">– enables reporting to monitor secure network beacons. This can be used to diagnose the network IV index and the IV Update procedure state.</span></p><p class="s5" style="padding-bottom: 2pt;text-indent: 0pt;text-align: right;">Additional Resources</p><p style="padding-left: 21pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="724" height="1" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_010.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ul></li><li><h4 style="padding-left: 40pt;text-indent: -18pt;text-align: left;"><a name="bookmark16">Additional Resources</a></h4></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;">Consult the following resources for additional information.</p><ul id="l18"><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;"><a href="https://www.silabs.com/documents/public/quick-start-guides/qsg176-bluetooth-mesh-sdk-v2x-quick-start-guide.pdf" class="a" target="_blank">QSG176: Bluetooth® Mesh SDK v2.x Quick-Start </a><a href="https://www.silabs.com/documents/public/quick-start-guides/qsg176-bluetooth-mesh-sdk-v2x-quick-start-guide.pdf" target="_blank">Guide</a></p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Silicon Labs Bluetooth Mesh API Reference Manual</p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;"><a href="https://www.bluetooth.com/wp-content/uploads/2019/03/Mesh-Technology-Overview.pdf" class="a" target="_blank">Bluetooth Mesh Networking - An Introduction for </a><a href="https://www.bluetooth.com/wp-content/uploads/2019/03/Mesh-Technology-Overview.pdf" target="_blank">Developers</a></p></li><li><p style="padding-top: 3pt;padding-left: 37pt;text-indent: -14pt;text-align: left;">Bluetooth Mesh Profile Specification v1.0.1</p></li></ul><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 36pt;text-indent: 0pt;text-align: left;">Simplicity Studio</h2><p class="s16" style="padding-top: 14pt;padding-left: 36pt;text-indent: 0pt;line-height: 122%;text-align: left;">One-click access to MCU and wireless tools, documentation, software, source code libraries &amp; more. Available for Windows, Mac and Linux!</p><p style="text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><span><img width="768" height="432" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_011.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:63.94pt" cellspacing="0"><tr style="height:99pt"><td style="width:98pt" bgcolor="#231F20"><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 15pt;text-indent: 0pt;text-align: left;"><span><img width="66" height="66" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_012.png"/></span></p><p style="padding-top: 10pt;padding-left: 1pt;padding-right: 19pt;text-indent: 0pt;text-align: center;"><a href="https://www.silabs.com/solutions/iot" class="s17">IoT Portfolio</a></p><p style="padding-top: 1pt;padding-left: 1pt;padding-right: 19pt;text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="http://www.silabs.com/IoT" class="s18">www.silabs.com/IoT</a></p></td><td style="width:126pt"><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 18pt;padding-right: 8pt;text-indent: 0pt;text-align: center;"><a href="https://www.silabs.com/simplicity" class="s17">SW/HW</a></p><p style="padding-top: 1pt;padding-left: 18pt;padding-right: 8pt;text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="http://www.silabs.com/simplicity" class="s18">www.silabs.com/simplicity</a></p></td><td style="width:126pt"><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 18pt;padding-right: 8pt;text-indent: 0pt;text-align: center;"><a href="https://www.silabs.com/about-us/corporate-responsibility/commitment-to-quality" class="s17">Quality</a></p><p style="padding-top: 1pt;padding-left: 18pt;padding-right: 8pt;text-indent: 0pt;line-height: 8pt;text-align: center;"><a href="http://www.silabs.com/quality" class="s18">www.silabs.com/quality</a></p></td><td style="width:126pt"><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 12pt;text-indent: 0pt;text-align: left;"><a href="https://www.silabs.com/community" class="s17" target="_blank">Support &amp; Community</a></p><p style="padding-top: 1pt;padding-left: 13pt;text-indent: 0pt;line-height: 8pt;text-align: left;"><a href="http://www.silabs.com/community" class="s18">www.silabs.com/community</a></p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="131" height="131" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_013.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="131" height="131" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_014.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="131" height="131" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_015.png"/></span></p><p class="s19" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Disclaimer</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 10pt;text-align: justify;">Silicon Labs intends to provide customers with the latest, accurate, and in-depth documentation of all peripherals and modules available for system and software imple- menters using or intending to use the Silicon Labs products. Characterization data, available modules and peripherals, memory sizes and memory addresses refer to each <span class="s21">specific device, and “Typical” parameters provided can and do vary in different applications. Application examples described herein are for illustrative purposes only. Silicon Labs reserves the right to make changes without further notice to the product information, specifications, and descriptions herein, and does not give warranties as to the accuracy or completeness of the included information. Without prior notification, Silicon Labs may update product firmware during the manufacturing process for security or reliability reasons. Such changes will not alter the specifications or the performance of the product. Silicon Labs shall have no liability for the consequences of use of the infor</span>- mation supplied in this document. This document does not imply or expressly grant any license to design or fabricate any integrated circuits. The products are not designed or <span class="s21">authorized to be used within any FDA Class III devices, applications for which FDA premarket approval is required or Life Support Systems without the specific written consent of Silicon Labs. A “Life Support System” is any product or system intended to support or sustain life and/or health, which, if it fails, can be reasonably expected to result in significant personal injury or death. Silicon Labs products are not designed or authorized for military applications. Silicon Labs products shall under no circumstances be used </span>in weapons of mass destruction including (but not limited to) nuclear, biological or chemical weapons, or missiles capable of delivering such weapons. Silicon Labs disclaims <span class="s21">all express and implied warranties and shall not be responsible or liable for any injuries or damages related to use of a Silicon Labs product in such unauthorized applications. </span><b>Note: This content may contain offensive terminology that is now obsolete. Silicon Labs is replacing these terms with inclusive language wherever possible. For more </b><span class="s23">information, visit </span><a href="https://www.silabs.com/about-us/inclusive-lexicon-project" class="s25" target="_blank">www.silabs.com/about-us/inclusive-lexicon-project</a></p><p class="s23" style="padding-top: 8pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Trademark Information</p><p class="s26" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 117%;text-align: justify;"><span class="s20">Silicon Laboratories Inc.</span>®<span class="s20">, Silicon Laboratories</span>®<span class="s20">, Silicon Labs</span>®<span class="s20">, SiLabs</span>® <span class="s20">and the Silicon Labs logo</span>®<span class="s20">, Bluegiga</span>®<span class="s20">, Bluegiga Logo</span>®<span class="s20">, Clockbuilder</span>®<span class="s20">, CMEMS</span>®<span class="s20">, DSPLL</span>®<span class="s20">, EFM</span>®<span class="s20">, EFM32</span>®<span class="s20">, EFR, Ember</span>®<span class="s21">, Energy Micro, Energy Micro logo and combinations thereof, “the world’s most energy friendly microcontrollers”, Ember</span>®<span class="s20">, EZLink</span>®<span class="s20">, EZRadio</span>®<span class="s20">, EZRadioPRO</span>®<span class="s20">, Gecko</span>®<span class="s20">, Gecko OS, Gecko OS Studio, ISOmodem</span>®<span class="s20">, Precision32</span>®<span class="s20">, ProSLIC</span>®<span class="s20">, Simplicity Studio</span>®<span class="s20">, SiPHY</span>®<span class="s20">, Telegesis, the Telegesis Logo</span>®<span class="s20">, USBXpress</span>® <span class="s20">, Zentri, the Zentri logo and Zentri DMS, Z-Wave</span>®<span class="s20">, and others are trademarks or registered trademarks of Silicon Labs. ARM, CORTEX, Cortex-M3 and THUMB are trademarks or registered trademarks of ARM Hold- ings. Keil is a registered trademark of ARM Limited. Wi-Fi is a registered trademark of the Wi-Fi Alliance. All other products or brand names mentioned herein are trademarks of their respective holders.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="148" height="73" alt="image" src="an1318-bluetooth-mesh-iv-update/Image_016.png"/></span></p><p class="s23" style="padding-top: 5pt;padding-left: 149pt;text-indent: 0pt;text-align: left;">Silicon Laboratories Inc. 400 West Cesar Chavez Austin, TX 78701</p><p class="s23" style="padding-left: 149pt;text-indent: 0pt;line-height: 8pt;text-align: left;">USA</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 149pt;text-indent: 0pt;text-align: left;"><h3 href="http://www.silabs.com/">www.silabs.com</h3></p></body></html>
