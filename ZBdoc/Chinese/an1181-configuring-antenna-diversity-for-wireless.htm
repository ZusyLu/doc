<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>AN1181: Configuring Antenna Diversity for EmberZNet</title><meta name="author" content="Silicon Labs"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 24pt; }
 .s1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s2 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s3 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .p, p { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s4 { color: #D81E2A; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h3 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 .a { color: #049; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s5 { color: #049; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s6 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s7 { color: #D81E2A; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s8 { color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s9 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s10 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s11 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 h4 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s12 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s13 { color: #FFF; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s14 { color: #FFF; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s15 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s16 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 h2 { color: #D91F2A; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt; }
 #l3> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l4 {padding-left: 0pt;counter-reset: d2 1; }
 #l4> li>*:first-child:before {counter-increment: d2; content: counter(d2, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 li {display: block; }
 #l5 {padding-left: 0pt;counter-reset: f1 2; }
 #l5> li>*:first-child:before {counter-increment: f1; content: counter(f1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l5> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l6 {padding-left: 0pt;counter-reset: f2 1; }
 #l6> li>*:first-child:before {counter-increment: f2; content: counter(f1, decimal)"."counter(f2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: f2 0;  }
 #l7 {padding-left: 0pt;counter-reset: f3 1; }
 #l7> li>*:first-child:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l7> li:first-child>*:first-child:before {counter-increment: f3 0;  }
 #l8 {padding-left: 0pt;counter-reset: f4 1; }
 #l8> li>*:first-child:before {counter-increment: f4; content: counter(f4, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l8> li:first-child>*:first-child:before {counter-increment: f4 0;  }
 #l9 {padding-left: 0pt; }
 #l9> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l10 {padding-left: 0pt; }
 #l10> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l11 {padding-left: 0pt;counter-reset: f3 1; }
 #l11> li>*:first-child:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: f3 0;  }
 #l12 {padding-left: 0pt;counter-reset: f4 1; }
 #l12> li>*:first-child:before {counter-increment: f4; content: counter(f4, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l12> li:first-child>*:first-child:before {counter-increment: f4 0;  }
 #l13 {padding-left: 0pt;counter-reset: f4 1; }
 #l13> li>*:first-child:before {counter-increment: f4; content: counter(f4, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l13> li:first-child>*:first-child:before {counter-increment: f4 0;  }
 #l14 {padding-left: 0pt; }
 #l14> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l15 {padding-left: 0pt; }
 #l15> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l16 {padding-left: 0pt; }
 #l16> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l17 {padding-left: 0pt; }
 #l17> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l18 {padding-left: 0pt; }
 #l18> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l19 {padding-left: 0pt; }
 #l19> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;"><span><img width="126" height="62" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_001.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">AN1181: Configuring Antenna Diversity for EmberZNet</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="1" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_002.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="204" height="1" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_003.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">KEY POINTS</p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="205" height="1" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_004.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l1"><li><p class="s2" style="padding-top: 4pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Describes antenna diversity and the transmit and receive implementations</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Provides instructions and examples for configuring transmit and receive antenna diversity.</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: justify;">Includes additional configuration information if antenna diversity is implemented with a FEM.</p></li></ul><p style="text-indent: 0pt;text-align: left;"/><p class="s3" style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">This document describes how to use Application Builder plugins and the Hardware Configurator to configure Antenna Diversity in EmberZNet applications. Both receive and transmit antenna di- versity configuration are discussed.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;line-height: 182%;text-align: left;">This information applies to EmberZNet version 6.5.0 and higher. RX antenna diversity is not supported on the EFR32xG22 family.</p><p class="s4" style="padding-bottom: 3pt;text-indent: 0pt;text-align: right;">About Antenna Diversity</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_005.png"/></span></p><ol id="l2"><li><h3 style="padding-top: 7pt;padding-left: 39pt;text-indent: -15pt;text-align: left;"><a name="bookmark0">About Antenna Diversity</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 23pt;text-indent: 0pt;text-align: justify;"><a href="https://www.silabs.com/documents/public/white-papers/using-antenna-diversity-to-create-highly-robust-radio-links.pdf" style=" color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;" target="_blank">Antenna diversity is a technique used to improve radio performance by using two different antennas to transmit and/or receive messag- es. For a more detailed explanation of the problems with signal transmission and reception in indoor environments and how antenna diversity can mitigate those problems, see </a><a href="https://www.silabs.com/documents/public/white-papers/using-antenna-diversity-to-create-highly-robust-radio-links.pdf" class="a" target="_blank">https://www.silabs.com/documents/public/white-papers/using-antenna-diversity-to-create- </a>highly-robust-radio-links.pdf<span style=" color: #000;">.</span></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Antenna diversity may be applied to transmission (Tx) and/or reception (Rx). Diversity is achieved using an external RF switch, either standalone or as part of a FEM (front end module)/LNA (low noise amplifier).</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The Tx algorithm uses reception of the packet acknowledgement (ACK) to determine if it should change antennas. If the device does not receive an ACK after packet transmission it toggles the RF switch to the other antenna and tries again. It retries two more times, for a total of four attempts, before the MAC (media access layer) fails the transmit up to the network layer. Specifically, the worst-case scenario is as follows:</p><ul id="l3"><li><p style="padding-top: 2pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">New MAC packet transmitted on antenna 1.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">No ACK received so antenna is switched to antenna 2.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">MAC retransmit #1 sent on antenna 2.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">No ACK received, so antenna is switched to antenna 1.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">MAC retransmit #2 sent on antenna 1.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">No ACK received, so antenna is switched to antenna 2.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">MAC retransmit #3 sent on antenna 2.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">No ACK received, so antenna is switched to antenna 1.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">(MAC retries have exhausted, so MAC fails transmit to network layer).</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">The next transmit will start on antenna 1.</p></li></ul><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">If transmission is successful, at the beginning of the next transmission the device starts on the last successfully-used antenna.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">In Rx antenna diversity with RSSI, the receiver alternates between antenna 1 and antenna 2 during the timing search looking for a valid timing pattern on the incoming signal. When a valid timing pattern is found, antenna diversity tries to select the best antenna for receiv- ing the rest of the frame. To achieve this, the signal quality for the currently active antenna is saved/updated at every subsequent an- tenna switch. Therefore, at the first timing detect event the algorithm already has a fresh quality metric for one antenna. To perform a valid comparison between antenna 1 and antenna 2, the radio switches simultaneously with the timing detect event to the other anten- na to perform a signal quality evaluation/update there. Finally, antenna quality results get compared, and the algorithm selects the bet- ter antenna for packet reception. If the better antenna is the current antenna, then the Rx operation carries on with packet reception without further antenna switching. If the better antenna is the other antenna then the radio switches to that one, reacquires timing and carries on with packet reception on that antenna.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">In antenna diversity, longer preambles are often used to provide the antenna diversity algorithm time to detect and evaluate the signal on each antenna to ensure that a true preamble is found. However, shorter preambles are preferred as they reduce MCU on-time and in turn reduce MCU current consumption. The RSSI measurement technique for evaluating signal quality requires less preamble time than other methods such as timing correlation.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Note that antenna Rx diversity is available for testing and evaluation purposes on the Gecko SDK suite. Due to the short preambles on the 802.15.4 packets, customers will need to make their own assessment on the performance and production readiness of this feature.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Rx and Tx antenna diversity are independent operations. In practice this means that, for example, Tx antenna diversity will begin the next transmission on the last successfully used antenna for Tx (for example antenna 1), even though in the intervening receive Rx an- tenna diversity found better signal quality on antenna 2.</p></li><li><h3 style="padding-top: 7pt;padding-left: 39pt;text-indent: -15pt;text-align: left;"><a name="bookmark1">Configuring Antenna Diversity</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">The antenna diversity configuration options available for EmberZNet consist of selecting Rx and/or Tx antenna diversity and configuring the underlying peripherals correctly. To configure antenna diversity, you must be familiar with your device’s overall antenna configura- tion, that is, if it uses a FEM/LNA for either Tx or Rx, and also be familiar with the device’s pin layout. Check the data sheet for your device for these settings or contact Silicon Labs support if you have questions.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">These instructions assume you have installed Simplicity Studio and the EmberZNet SDK (software development kit), and that you have a project open in the Simplicity IDE (integrated development environment).</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">The steps to set up antenna diversity are described in detail below. In summary:</p><ol id="l4"><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">On the plugins tab, disable the antenna stub plugin and enable the antenna plugin</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Configure the antenna plugin.</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">If you are configuring Rx diversity either alone or with Tx diversity, finish the configuration in the Hardware Configurator.</p></li></ol></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l5"><ol id="l6"><li><p class="s6" style="padding-top: 5pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark2">Antenna Plugin Settings</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l7"><li><p class="s6" style="padding-top: 5pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark3">Enable the Antenna Plugin (Required)</a></p><ol id="l8"><li><p style="padding-top: 8pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">In the Plugins tab, search for Antenna plugin, located in the HAL plugins group.</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Disable (uncheck) the Antenna stub plugin and enable (check) the Antenna plugin.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 69pt;text-indent: 0pt;text-align: left;"><span><img width="643" height="295" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_006.jpg"/></span></p><p class="s6" style="padding-top: 8pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.1.  Antenna Plugin Enabled</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;text-align: left;">When you enable the Antenna plugin, a warning is displayed. This is expected behavior. If you will be modifying configurations frequently, check <b>Do not show this anymore</b>. Click [<b>OK</b>].</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 177pt;text-indent: 0pt;text-align: left;"><span><img width="356" height="116" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_007.jpg"/></span></p><p class="s6" style="padding-top: 6pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.2.  Antenna Diversity Peripherals Warning</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p style="padding-left: 41pt;text-indent: -8pt;text-align: left;">Configure the Antenna Diversity Options for Tx and Rx using plugins, as described in the next sections.</p></li></ol></li><li><p class="s6" style="padding-top: 8pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark4">Configure Tx Diversity in the Antenna Plugin</a></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">The default configuration for the antenna plugin is Tx Diversity enabled. An EmberZNet project is shown as an example. Note that some of these options are only available in Gecko SDK 2.6.0 and above.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 43pt;text-indent: 0pt;text-align: left;"><span><img width="664" height="297" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_008.jpg"/></span></p><p class="s6" style="padding-top: 8pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.3.  Antenna Diversity TX Mode</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">The options for <b>Antenna Diversity TX Mode </b>are as follows:</p><ul id="l9"><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Disabled: Tx antenna diversity plugin does not control ANTENNA_SELECT_GPIO.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable1: ANTENNA_SELECT_GPIO is set to high during Tx.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable2: ANTENNA_SELECT_GPIO is set to low during Tx.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Diversity: Tx antenna selection is dynamic and Tx diversity is enabled.</p></li></ul><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Antenna select: <a href="#bookmark12" style=" color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">Pin used to control the external antenna switch if only Tx diversity is enabled. A pin can be set directly through this option, or it can inherit the setting from MODEM in Hardware Configurator (see section </a><span class="s5">2.2 Hardware Configurator Settings</span><span class="p">). Note that if Rx diversity is also enabled, only MODEM will be available.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Complementary antenna select<span class="p">: Pin for the inverted external antenna signal. A pin can be set directly through this option, or it can inherit the setting from MODEM in Hardware Configurator. Note that if Rx diversity is also enabled, only MODEM will be available.</span></p></li><li><p class="s6" style="padding-top: 8pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark5">Configure Rx Diversity in the Antenna Plugin</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 57pt;text-indent: 0pt;text-align: left;"><span><img width="630" height="352" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_009.jpg"/></span></p><p class="s6" style="padding-top: 6pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.4.  Antenna Diversity RX Mode</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">The options for <b>Antenna Diversity RX Mode </b>are:</p><ul id="l10"><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Disabled: Rx antenna diversity plugin does not control ANTENNA_SELECT_GPIO.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable1: ANTENNA_SELECT_GPIO is set to high during Rx.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable2: ANTENNA_SELECT_GPIO is set to low during Rx.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Diversity: Rx antenna selection is dynamic and diversity is enabled.</p></li></ul><p class="s6" style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Antenna Port pin selection: <a href="#bookmark12" style=" color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt;">Selection of the antenna port pin must be done through the Modem peripheral in Hardware Configurator (see section </a><span class="s5">2.2 Hardware Configurator Settings</span><span class="p">). Note that this option changes after you pick an option for </span>Rx Diversity. <span class="p">Select the </span>Diversity <span class="p">option first before attempting to change the antenna select option.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Enable selecting the Rx antenna diversity PHY at runtime: <span class="p">On Gecko SDK 2.6.0 and above, there is an additional option to change diversity settings at runtime. When this option is set to True, both the standard and the diversity-enabled PHY are compiled into the image, thereby allowing the application to use API calls to change PHY (from standard to diversity or vice-versa) at runtime. Note that the code size of the image will increase significantly when this option is set to True.</span></p></li><li><p class="s6" style="padding-top: 8pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark6">Configure Rx and Tx Diversity in the Antenna Plugin</a></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">To configure both Rx and Tx antenna diversity, set them both in the Antenna plugin.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 21pt;text-indent: 0pt;text-align: left;"><span><img width="724" height="349" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_010.jpg"/></span></p><p class="s6" style="padding-top: 7pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.5.  The Antenna Plugin Configured for both Tx and Rx Diversity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;">Because Rx diversity is enabled, pin configuration must be done in the Hardware Configurator, as described in the following section.</p></li></ol></li><li><p class="s6" style="padding-top: 8pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark7">Hardware Configurator Settings</a><a name="bookmark12">&zwnj;</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l11"><li><p class="s6" style="padding-top: 5pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark8">Configure the Antenna Pins</a></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">The <b>Antenna select </b>and <b>Complementary antenna select </b>pins can also be configured through Hardware Configurator for Tx diversity, and must be configured in Hardware Configurator for Rx diversity. To open the Hardware Configurator:</p><ol id="l12"><li><p style="padding-top: 2pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">Select the <b>HAL </b>tab.</p></li><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">In the Hardware Configurator group, click [<b>Open Hardware Configurator</b>].</p></li><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">Select the <b>Default Mode Peripherals </b>tab.</p></li><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">Select <b>MODEM </b>and the two parameters are displayed, configured as Disabled (or whatever pin was selected in the plugin).</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Select the pins for <b>Antenna Select </b>and, if applicable, <b>Complementary antenna select. </b>The Antenna select signal goes high to select antenna 1 and low to select antenna 2.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 66pt;text-indent: 0pt;text-align: left;"><span><img width="650" height="373" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_011.jpg"/></span></p><p class="s6" style="padding-top: 8pt;padding-left: 147pt;text-indent: 0pt;text-align: left;">Figure 2.6. TX Antenna Diversity Pin Configuration in Hardware Configurator</p></li></ol></li><li><p class="s6" style="padding-top: 8pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark9">Configure the FEM (optional)</a></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">If antenna diversity is implemented using a FEM, you must</p><ol id="l13"><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Enable the FEM driver plugin on the Plugins tab in the HAL plugins group.</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Configure the driver.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">The driver can be configured in the Plugins tab, or in Hardware Configurator. The options are the same. These instructions are for the Hardware Configurator.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">In the Radio group, select the <b>External FEM </b>peripheral.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;"><span><img width="715" height="434" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_012.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.7.  Hardware Configurator External FEM Peripheral</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">Not all FEM configuration options apply to all FEMs. Specifically <b>Bypass </b>and <b>Tx Power </b>only apply to FEMs with the pins to support the features, such as the SKY66112. Check your FEM datasheet for the settings required.</p><p class="s7" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">NOTE: <span class="p">Since there are a limited number of PRS channels, care must be taken so they do not conflict with channels that might be selec- ted in other plugins.</span></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">The FEM configuration options are:</p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">RX PRS channel<span class="p">: PRS Channel for Rx control (FEM pin CRX). If no Tx is defined, it is a dual-use (Rx/Tx) pin. The options are Disabled or a channel number. Once a channel is selected, the </span>PRS channel output pin <span class="p">can be configured.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Sleep PRS channel: <span class="p">PRS channel for sleep control (FEM pin CSD). The options are Disabled or a channel number. If the setting is enabled, it must be configured to be the channel immediately following the RX PRS channel. If set incorrectly, it will result in a compile error. Once a channel is enabled, the </span>PRS channel output pin <span class="p">can be configured.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">TX PRS channel<span class="p">: PRS channel for Tx control (FEM pin CTX). The options are Disabled or a channel number. If the setting is disabled, then the software assumes that the FEM pin CRX is a dual use pin. Once a channel is enabled, the </span>PRS channel output pin <span class="p">can be configured.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Enable RX mode: <span class="p">Configures RX mode on the FEM. The options are True or False. This option must be set to True and the Antenna Diversity Plugin enabled in order for the underlying antenna diversity radio configuration settings to be used. If it is set to false, then the standard radio configuration settings are used.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">Enable TX mode: <span class="p">Configures TX mode on the FEM. The options are True or False.</span></p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">Bypass <span class="p">(optional)</span></p><ul id="l14"><li><p class="s6" style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Bypass Pin: <span class="p">If the FEM has a pin for the bypass signal (CPS) select it.</span></p></li><li><p class="s6" style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable bypass Mode: <span class="p">Set to True to enable communication that bypasses the LNA (low noise amplifier).</span></p><p class="s6" style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">Power <span class="p">(optional)</span></p></li><li><p class="s6" style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">TX power pin: <span class="p">If the FEM has a pin for Tx power mode (CHL) select it.</span></p></li><li><p class="s6" style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Enable high power tx: <span class="p">Set to True to enable high power Tx, set to False to enable low power Tx.</span></p></li></ul><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">For example, a FEM such as the Skyworks 66112 configured for Rx antenna diversity, with receive bypass pin configured but bypass mode not enabled, would look like the following figure:</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 201pt;text-indent: 0pt;text-align: left;"><span><img width="248" height="327" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_013.jpg"/></span></p><p class="s6" style="padding-top: 5pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.8.  FEM Configured for Rx Antenna Diversity</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;">Note that options in blue have not yet been saved to the board header file.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li><p class="s6" style="padding-top: 5pt;padding-left: 49pt;text-indent: -25pt;text-align: left;"><a name="bookmark10">Update the FEM Driver (applicable to older stacks only)</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Project (ISC) files that use the legacy FEM control plugin (based on EmberZNet SDK version 6.1 or earlier) do not update automatically to the new FEM plugin, which has merged the functionality of FEM control and LNA. The ISC file previously used plugin options to configure elements of its software platform, and this configuration is now done though Hardware Configurator. AppBuilder will attempt to migrate the relevant plugin options to Hardware Configurator. Verify that the property <span class="s8">ABPeripheral.included </span>on module <span class="s8">FEM </span>is set to <span class="s8">True </span>in the project&#39;s .hwconf file.</p><p style="padding-top: 7pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">You must add the following to the .hwconf file based on your old plugin options. Note that if only TX location and channel are defined, it is changed to be RX.</p><ul id="l15"><li><p style="padding-top: 2pt;padding-left: 36pt;text-indent: -36pt;text-align: right;">If only RX or TX channel and location are defined:</p><ul id="l16"><li><p style="padding-top: 3pt;padding-left: 48pt;text-indent: -48pt;text-align: right;">Set the <span class="s8">RX PRS channel </span>to the used channel.</p></li><li><p style="padding-top: 2pt;padding-left: 48pt;text-indent: -9pt;text-align: left;">Set the <span class="s8">PRS channel &lt;rx or tx channel&gt; output pin </span>to the used pin.</p></li></ul></li><li><p style="padding-top: 2pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">If both RX and TX channel and location are defined:</p><ul id="l17"><li><p style="padding-top: 3pt;padding-left: 48pt;text-indent: -9pt;text-align: left;">Set RX properties as above, and do the same for TX.</p></li></ul></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">If <span class="s8">rxActive </span>or <span class="s8">txActive </span>is defined:</p><ul id="l18"><li><p style="padding-top: 2pt;padding-left: 48pt;text-indent: -9pt;text-align: left;">Set corresponding <span class="s8">Enable RX mode </span>or <span class="s8">Enable TX mode </span>to <span class="s8">True.</span></p></li></ul></li><li><p style="padding-top: 2pt;padding-left: 36pt;text-indent: -9pt;text-align: left;">Select channel and output pin for SLEEP pin:</p><ul id="l19"><li><p style="padding-top: 3pt;padding-left: 48pt;text-indent: -9pt;text-align: left;">Set <span class="s8">Sleep PRS channel </span>and <span class="s8">PRS channel &lt;sleep channel&gt; output pin.</span></p></li></ul></li></ul></li></ol></li><li><p class="s6" style="padding-top: 8pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark11">Command Line Interface</a></p></li></ol></ol><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">Gecko SDK.2.6.0 and above provide a means to query and set Rx and Tx diversity modes using the Antenna CLI plugin.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 40pt;text-indent: 0pt;text-align: left;"><span><img width="675" height="324" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_014.jpg"/></span></p><p class="s6" style="padding-top: 7pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Figure 2.9.  Antenna CLI Plugin</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-top: 6pt;padding-left: 139pt;text-indent: 0pt;text-align: center;">Table 2.1.  Antenna Diversity CLI Description</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:24pt" cellspacing="0"><tr style="height:17pt"><td style="width:63pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Command</p></td><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 14pt;padding-right: 4pt;text-indent: -10pt;line-height: 106%;text-align: left;">Command De- scription</p></td><td style="width:173pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2" bgcolor="#797777"><p class="s10" style="padding-top: 3pt;padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;text-align: center;">API Function</p></td><td style="width:260pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" colspan="3" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 108pt;padding-right: 107pt;text-indent: 0pt;text-align: center;">Arguments</p></td></tr><tr style="height:17pt"><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 15pt;padding-right: 14pt;text-indent: 0pt;text-align: center;">Name</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;text-align: center;">Type</p></td><td style="width:169pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s9" style="padding-top: 3pt;padding-left: 61pt;padding-right: 60pt;text-indent: 0pt;text-align: center;">Description</p></td></tr><tr style="height:56pt"><td style="width:63pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">plugin antenna</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 106%;text-align: left;">get-antenna-tx- mode</p></td><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;padding-right: 5pt;text-indent: 0pt;line-height: 106%;text-align: left;">Returns the current setting for the antenna tx diversity mode</p></td><td style="width:173pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;text-align: center;">emberAfPluginAntennaGetAntennaTxMode</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 15pt;padding-right: 14pt;text-indent: 0pt;text-align: center;">n/a</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;text-align: center;">n/a</p></td><td style="width:169pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;padding-right: 2pt;text-indent: 0pt;line-height: 106%;text-align: left;">Interpretation of returned results for get oper- ation and permissible values for set opera- tion are as below:</p><p class="s11" style="padding-top: 7pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">HAL_ANTENNA_MODE_DISABLED: 0</p></td></tr><tr style="height:45pt"><td style="width:63pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">plugin antenna</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 106%;text-align: left;">set-antenna-tx- mode</p></td><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;padding-right: 3pt;text-indent: 0pt;line-height: 106%;text-align: left;">Sets tx diversity mode to argu- ment</p></td><td style="width:173pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;text-align: center;">emberAfPluginAntennaSetAntennaTxMode</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 16pt;padding-right: 5pt;text-indent: -10pt;line-height: 106%;text-align: left;">Tx Antenna Mode</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;text-align: center;">uint8_t</p></td><td style="width:169pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt" rowspan="2"><p class="s11" style="padding-top: 2pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">HAL_ANTENNA_MODE_ENABLE1: 1</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">HAL_ANTENNA_MODE_ENABLE2: 2</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;text-indent: 0pt;line-height: 9pt;text-align: left;">HAL_ANTENNA_MODE_DIVERSITY: 3</p></td></tr><tr style="height:3pt"><td style="width:63pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:173pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:44pt"><td style="width:63pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">plugin antenna</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;padding-right: 3pt;text-indent: 0pt;line-height: 106%;text-align: left;">get-antenna-rx- mode</p></td><td style="width:64pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-left: 2pt;padding-right: 8pt;text-indent: 0pt;line-height: 106%;text-align: left;">Returns the current setting for antenna rx diversity mode</p></td><td style="width:173pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;text-align: center;">emberAfPluginAntennaGetAntennaRxMode</p></td><td style="width:54pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-left: 15pt;padding-right: 14pt;text-indent: 0pt;text-align: center;">n/a</p></td><td style="width:37pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;text-align: center;">n/a</p></td><td style="width:169pt;border-left-style:solid;border-left-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:45pt"><td style="width:63pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">plugin antenna</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s11" style="padding-left: 2pt;padding-right: 4pt;text-indent: 0pt;line-height: 106%;text-align: left;">set-antenna-rx- mode</p></td><td style="width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;padding-right: 3pt;text-indent: 0pt;line-height: 106%;text-align: left;">Sets rx diversity mode to argu- ment</p></td><td style="width:173pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 7pt;padding-right: 7pt;text-indent: 0pt;text-align: center;">emberAfPluginAntennaSetAntennaRxMode</p></td><td style="width:54pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 16pt;padding-right: 5pt;text-indent: -11pt;line-height: 106%;text-align: left;">Rx Antenna Mode</p></td><td style="width:37pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 5pt;padding-right: 5pt;text-indent: 0pt;text-align: center;">uint8_t</p></td><td style="width:169pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr></table><p style="padding-top: 7pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Tx diversity settings can be changed using the CLI without any restriction. However, Rx Diversity options that require switching from standard PHY to diversity PHY or vice-versa may only be permitted when the plugin option <b>Enable selecting RX antenna diversity PHY at runtime </b>is set to True.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Smart. Connected. Energy-Friendly.</h4><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Products</p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.silabs.com/products" class="s13">www.silabs.com/products</a></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Quality</p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.silabs.com/quality" class="s13">www.silabs.com/quality</a></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Support and Community</p><p class="s14" style="text-indent: 0pt;text-align: center;">community.silabs.com</p><p style="padding-left: 64pt;text-indent: 0pt;text-align: left;"><span style=" color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt;">		</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="767" height="695" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_015.png"/></span></p><p class="s15" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Disclaimer</p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Silicon Labs intends to provide customers with the latest, accurate, and in-depth documentation of all peripherals and modules available for system and software implementers using or intending to use the Silicon Labs products. Characterization data, available modules and peripherals, memory sizes and memory addresses refer to each specific device, and &quot;Typical&quot; parameters provided can and do vary in different applications. Application examples described herein are for illustrative purposes only. Silicon Labs reserves the right to make changes without further notice to the product information, specifications, and descriptions herein, and does not give warranties as to the accuracy or completeness of the included information. Without prior notification, Silicon Labs may update product firmware during the manufacturing process for security or reliability reasons. Such changes will not alter the specifications or the performance of the product. Silicon Labs shall have no liability for the consequences of use of the information supplied in this document. This document does not imply or expressly grant any license to design or fabricate any integrated circuits. The products are not designed or authorized to be used within any FDA Class III devices, applications for which FDA premarket approval is required, or Life Support Systems without the specific written consent of Silicon Labs. A &quot;Life Support System&quot; is any product or system intended to support or sustain life and/or health, which, if it fails, can be reasonably expected to result in significant personal injury or death. Silicon Labs products are not designed or authorized for military applications. Silicon Labs products shall under no circumstances be used in weapons of mass destruction including (but not limited to) nuclear, biological or chemical weapons, or missiles capable of delivering such weapons. Silicon Labs disclaims all express and implied warranties and shall not be responsible or liable for any injuries or damages related to use of a Silicon Labs product in such unauthorized applications.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s15" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Trademark Information</p><p class="s16" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Silicon Laboratories Inc.®, Silicon Laboratories®, Silicon Labs®, SiLabs® and the Silicon Labs logo®, Bluegiga®, Bluegiga Logo®, ClockBuilder®, CMEMS®, DSPLL®, EFM®, EFM32®, EFR, Ember®, Energy Micro, Energy Micro logo and combinations thereof, &quot;the world’s most energy friendly microcontrollers&quot;, Ember®, EZLink®, EZRadio®, EZRadioPRO®, Gecko®, Gecko OS, Gecko OS Studio, ISOmodem®, Precision32®, ProSLIC®, Simplicity Studio®, SiPHY®, Telegesis, the Telegesis Logo®, USBXpress® , Zentri, the Zentri logo and Zentri DMS, Z- Wave®, and others are trademarks or registered trademarks of Silicon Labs. ARM, CORTEX, Cortex-M3 and THUMB are trademarks or registered trademarks of ARM Holdings. Keil is a registered trademark of ARM Limited. Wi-Fi is a registered trademark of the Wi-Fi Alliance. All other products or brand names mentioned herein are trademarks of their respective holders.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="152" height="75" alt="image" src="an1181-configuring-antenna-diversity-for-wireless/Image_016.png"/></span></p><p class="s15" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">Silicon Laboratories Inc. 400 West Cesar Chavez Austin, TX 78701</p><p class="s15" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">USA</p><p style="padding-top: 5pt;padding-left: 168pt;text-indent: 0pt;text-align: left;"><h2 href="http://www.silabs.com/">http://www.silabs.com</h2></p></body></html>
