<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>AN706: EZSP-UART Host Interfacing Guide</title><meta name="author" content="Silicon Labs"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 h1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 24pt; }
 .s1 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 6pt; }
 .s2 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s3 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s5 { color: #D81E2A; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 h3 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 .p, p { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s6 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s7 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 .s8 { color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s9 { color: black; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s10 { color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s11 { color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 h4 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 10pt; }
 .s12 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 a { color: #FFF; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s13 { color: #FFF; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s14 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7pt; }
 .s15 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 h2 { color: #D91F2A; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l2 {padding-left: 0pt;counter-reset: d1 1; }
 #l2> li>*:first-child:before {counter-increment: d1; content: counter(d1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l2> li:first-child>*:first-child:before {counter-increment: d1 0;  }
 #l3 {padding-left: 0pt;counter-reset: d2 1; }
 #l3> li>*:first-child:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l3> li:first-child>*:first-child:before {counter-increment: d2 0;  }
 li {display: block; }
 #l4 {padding-left: 0pt;counter-reset: e1 1; }
 #l4> li>*:first-child:before {counter-increment: e1; content: counter(e1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l4> li:first-child>*:first-child:before {counter-increment: e1 0;  }
 #l5 {padding-left: 0pt;counter-reset: e2 1; }
 #l5> li>*:first-child:before {counter-increment: e2; content: counter(e2, lower-latin)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l5> li:first-child>*:first-child:before {counter-increment: e2 0;  }
 #l6 {padding-left: 0pt;counter-reset: e3 1; }
 #l6> li>*:first-child:before {counter-increment: e3; content: counter(e3, lower-roman)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l6> li:first-child>*:first-child:before {counter-increment: e3 0;  }
 li {display: block; }
 #l7 {padding-left: 0pt;counter-reset: f1 4; }
 #l7> li>*:first-child:before {counter-increment: f1; content: counter(f1, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
 #l7> li:first-child>*:first-child:before {counter-increment: f1 0;  }
 #l8 {padding-left: 0pt; }
 #l8> li>*:first-child:before {content: "• "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l9 {padding-left: 0pt;counter-reset: f2 1; }
 #l9> li>*:first-child:before {counter-increment: f2; content: counter(f1, decimal)"."counter(f2, decimal)" "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 9pt; }
 #l9> li:first-child>*:first-child:before {counter-increment: f2 0;  }
 #l10 {padding-left: 0pt;counter-reset: f3 1; }
 #l10> li>*:first-child:before {counter-increment: f3; content: counter(f3, decimal)". "; color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 #l10> li:first-child>*:first-child:before {counter-increment: f3 0;  }
 li {display: block; }
 #l11 {padding-left: 0pt;counter-reset: h1 1; }
 #l11> li>*:first-child:before {counter-increment: h1; content: counter(h1, decimal)". "; color: black; font-family:"Courier New", monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l11> li:first-child>*:first-child:before {counter-increment: h1 0;  }
 table, tbody {vertical-align: top; overflow: visible; }
</style></head><body><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;"><span><img width="126" height="62" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_001.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">AN706: EZSP-UART Host Interfacing Guide</h1><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="1" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_002.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="212" height="1" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_003.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">KEY POINTS</p><p style="padding-left: 9pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="213" height="1" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_004.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><ul id="l1"><li><p class="s2" style="padding-top: 4pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">EZSP-UART protocol overview</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Physical interfaces</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Command line options for Host applications</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Hardware design considerations</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Powering up, power cycling, and rebooting</p></li><li><p class="s2" style="padding-top: 3pt;padding-left: 17pt;text-indent: -7pt;text-align: left;">Bootloading</p></li></ul><p style="text-indent: 0pt;text-align: left;"/><p class="s3" style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">This application note describes how to connect a Host processor to a Network Co-Processor (NCP) using the UART-based Em- berZNet Serial Protocol (EZSP). It assumes that you already have a basic understanding of the EZSP-UART Gateway proto- col, as well as the signals needed by the UART interface. If not, refer to <i>UG101: UART Gateway Protocol Reference Guide </i>be- fore continuing. This application note has been updated to Em- berZNet PRO 6.6 to reflect a minor update to the Silicon Labs Zigbee application framework, though the content of the EZSP- UART interface still applies to earlier versions of the EmberZNet PRO stack.</p><p class="s5" style="padding-bottom: 3pt;text-indent: 0pt;text-align: right;">Protocol Overview</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_005.png"/></span></p><ol id="l2"><li><h3 style="padding-top: 7pt;padding-left: 39pt;text-indent: -15pt;text-align: left;"><a name="bookmark0">Protocol Overview</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">Silicon Labs designed EZSP as a protocol to allow communications between components running pieces of the EmberZNet PRO wire- less mesh stack, namely a Host processor and an NCP. The Host processor runs the application layer and executes on the POSIX platform such as Mac OS, Linux, or a Windows PC running Cygwin or the new Windows 10 BASH shell. You can also run this on an embedded platform like the Raspberry Pi. This lets you develop and test your application on an easy-to-use platform before porting your solution to a different Host processor with few changes. The NCP runs the EmberZNet PRO stack and physical layer (PHY). It is deployed and executed on a Silicon Labs wireless mesh chip processor such as the Wireless Gecko EFR32™.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><h3 style="padding-left: 42pt;text-indent: -18pt;text-align: left;"><a name="bookmark1">EZSP-UART Physical Interfaces</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: justify;">The following figure represents the EZSP-UART physical interfaces.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 115pt;text-indent: 0pt;text-align: left;"><span><img width="477" height="461" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_006.jpg"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 178pt;text-indent: 0pt;text-align: center;">Figure 2.1.  EZSP-UART Physical Interfaces</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l3"><li><p class="s6" style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><a name="bookmark2">Serial Data: Tx and Rx</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The EZSP protocol sends data in both directions, utilizing a standard Universal Asynchronous Receiver-Transmitter (UART). Both the Tx and Rx pins are utilized on the NPC and Host. When connecting the NCP and Host, the connections should be from NCP Tx to Host Rx and NCP Rx to Host Tx. This interface is required for NCP-to-Host communications.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p class="s6" style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><a name="bookmark3">Flow Control: RTS and CTS</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">EZSP requires flow control for operation. This can be in the form of either XON/XOFF software flow control or RTS/CTS hardware flow control. RTS/CTS hardware flow control is part of the standard UART interface. When connecting the NCP and Host, the connections should be from NCP CTS to Host RTS and NCP RTS to Host CTS. With this interface, RTS enables transmission from the Host to the NCP and CTS enables NCP transmissions to the Host.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">If needed, the Host can restrain the NCP from sending to it by deasserting the NCP’s CTS input. The NCP will stop sending immediate- ly, except to finish sending a byte already in progress. The NCP will do the same to the Host when it requires the Host to stop sending data.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">While hardware or software flow control can be utilized, EZSP-UART will have better performance and speed using hardware flow con- trol. Hardware flow control allows operation up to 115,200 bps (other baud rates may be selected by a configuration value programmed into flash during manufacturing).</p><p class="s5" style="padding-bottom: 3pt;text-indent: 0pt;text-align: right;">EZSP-UART Physical Interfaces</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_007.png"/></span></p></li><li><p class="s6" style="padding-top: 7pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark4">Reset Control: nRESET</a></p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">nRESET is a hardware input that can reset the NCP. For normal operation, the nRESET line should be held high. While pulling the line low, the NCP will hold in a reset state. Upon returning the line high, on the rising edge of the signal, the part will restart operation. Silicon Labs NCP chips include an internal pull-up resistor on this input so adding one is not necessary.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">The Host must be able to reset the NCP to run the EZSP protocol. This can normally be accomplished utilizing software reset frames sent via EZSP from the Host to the NCP. However, in cases where the NCP fails to respond to EZSP frames, this hardware backup can be utilized.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">While this interface is optional for NCP-to-Host communications, Silicon Labs recommends including nRESET in all Host-NCP hard- ware designs as a backup for situations where continued NCP operation is impossible or where unforeseen NCP operation blocks the Host.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">For secure designs (utilizing secure EZSP) or security products, these connections should be considered mandatory.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p class="s6" style="padding-top: 6pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark5">Recover / Bootload: Bootload</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The Bootload line allows the Host to force an NCP into bootloader mode during a reset or power cycle. For normal operation, the Boot- load line should be held high. During a reset (while the nRESET line is held low) or a power cycle, the Bootload line should be pulled low. Upon release of the nRESET line or powering up the NCP, the low input on the Bootload pin will signal the bootload software (Gecko or legacy) to override normal NCP operation, allowing the Host to update the firmware of the NCP. Because the Bootload pin can be configured on any input, a pull-up resistor should be placed on this input or set internally.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Bootloading is normally accomplished utilizing software bootload frames sent via EZSP from the Host to the NCP. However, in cases where the NCP fails to respond to EZSP frames, this hardware backup, in conjunction with nRESET, can be utilized.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">While this interface is optional for NCP-to-Host communications Silicon Labs recommends including the Bootload pin in all Host-NCP hardware designs as a backup for situations where unforeseen operation or corruption block the NCP from responding to any software commands from the Host.</p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">For secure designs (utilizing secure EZSP) or security products, these connections should be considered mandatory.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p class="s6" style="padding-top: 5pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark6">Pin Connections</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">The following table lists the pin connections.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 178pt;text-indent: 0pt;text-align: center;">Table 2.1.  Pin Connections</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:24pt" cellspacing="0"><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Pin number</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Description</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Tx</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Output</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Rx</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Input</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">RTS</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Input</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">CTS</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Output</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">nRESET</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Input</p></td></tr><tr style="height:19pt"><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Bootload</p></td><td style="width:270pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Input, Pull-up</p></td></tr></table></li></ol></li><li><h3 style="padding-top: 7pt;padding-left: 39pt;text-indent: -15pt;text-align: left;"><a name="bookmark7">Command Line Options for Host Applications</a></h3></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;">To test your Host-NCP interface Silicon Labs recommends that you build a Host application using AppBuilder. (If necessary, refer to</p><p class="s9" style="padding-left: 23pt;text-indent: 0pt;line-height: 182%;text-align: left;">QSG106: Getting Started with EmberZNet PRO <span class="p">for additional help.) &lt;Z3GatewayHost&gt; is the generic name for a Host application. To build your application, follow these steps:</span></p><ol id="l4"><li><p style="padding-left: 41pt;text-indent: -8pt;line-height: 10pt;text-align: left;">Launch Simplicity Studio.</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Change your perspective to the Simplicity IDE perspective.</p></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: left;">Create a new AppBuilder Host project:</p><ol id="l5"><li><p style="padding-top: 8pt;padding-left: 59pt;text-indent: -8pt;text-align: left;">Select <b>File &gt; New &gt; Project…</b></p></li><li><p style="padding-top: 3pt;padding-left: 59pt;text-indent: -8pt;text-align: left;">Select <b>Silicon Labs AppBuilder Project </b>and click <b>Next&gt;</b>.</p><ol id="l6"><li><p style="padding-top: 8pt;padding-left: 77pt;text-indent: -5pt;text-align: left;">Select <b>Silicon Labs Zigbee </b>and click <b>Next&gt;</b>.</p></li><li><p style="padding-top: 3pt;padding-left: 77pt;text-indent: -7pt;text-align: left;">Select <b>EmberZNet &lt;version&gt; Host </b>and click <b>Next&gt;</b>.</p></li><li><p style="padding-top: 3pt;padding-left: 77pt;text-indent: -9pt;text-align: left;">Select the <b>Z3 Gateway </b>application and click <b>Next&gt;</b>.</p></li><li><p style="padding-top: 3pt;padding-left: 77pt;text-indent: -10pt;text-align: left;">Enter a name for your project and click <b>Next&gt;</b>.</p></li><li><p style="padding-top: 3pt;padding-left: 78pt;text-indent: -8pt;text-align: left;">On the Project setup page, leave the board section blank. For the part make, sure <b>None </b>is selected. The toolchain should also reflect no toolchain as well (or <b>None</b>).</p></li><li><p style="padding-top: 2pt;padding-left: 78pt;text-indent: -10pt;text-align: left;">Click <b>Finish</b>.</p></li></ol></li></ol></li><li><p style="padding-top: 3pt;padding-left: 41pt;text-indent: -8pt;text-align: justify;">Simplicity Studio will now be displaying your Z3 Gateway ISC project file. The default settings are enough to test your EZSP set- tings. Select <b>Generate</b>. This will create the files for your project. The project is a POSIX-compliant Make project. You can transfer your project to your platform and build it using a standard <span class="s10">make </span>command.</p></li><li><p style="padding-top: 2pt;padding-left: 41pt;text-indent: -8pt;text-align: justify;">Once your project is built, you can run it and use the command line options to test your interface. As long as your application prop- erly interfaces the NCP and properly executes, you can be assured that your connections are working properly. You should see a message similar to this one:</p></li></ol><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;line-height: 107%;text-align: left;">./Z3GatewayHost -n 0 -p /dev/ttyAMA0 Reset info: 11 (SOFTWARE)</p><p class="s10" style="padding-left: 2pt;text-indent: 0pt;line-height: 107%;text-align: left;">ezsp ver 0x06 stack type 0x02 stack ver. [6.3.1 GA build 245] Ezsp Config: set source route table size to 0x0064:Success: set</p><p style="padding-left: 21pt;text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">The following table summarizes the &lt;Z3GatewayHost&gt; command line options.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 178pt;text-indent: 0pt;text-align: center;">Table 3.1.  &lt;Z3GatewayHost&gt; Command Line Options</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:24pt" cellspacing="0"><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Command Line Option</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Optional values</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Description</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-n</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">0,1</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">0<span class="s8">=115200 bps (RTS/CTS), </span>1<span class="s8">= 57600 bps (XON/XOFF)</span></p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-b</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">&lt;baud rate&gt;</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Baud Rate: 9600, 19200, 38400, 57600, 115200, etc.</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-f</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">r, x</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Flow control: <span class="s11">r</span>=RST/CTS, <span class="s11">x</span>=XON/XOFF</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-h</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Display usage information.</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-i</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">0, 1</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Enable/disable input buffering.</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-o</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">0, 1</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Enable/disable output buffering.</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-p</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">&lt;port name&gt;</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Serial port name or number (for example, COM1, ttyS0, or 1)</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-r</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">d, r, c</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">NCP reset method: <span class="s11">d</span>=DTR, <span class="s11">r</span>=RST frame, <span class="s11">c</span>=custom</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-s</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">1, 2</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Stop bits</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-t</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">&lt;trace flags&gt;</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Trace <span class="s11">B0</span>=frames, <span class="s11">B1</span>=verbose frames, <span class="s11">B2</span>=events, <span class="s11">B3</span>=EZSP</p></td></tr><tr style="height:73pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-v</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">[base port]</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;padding-right: 1pt;text-indent: 0pt;text-align: left;">Enables virtual ISA support. The <span class="s11">[base-port] </span>argument is optional. Both serial ports are available via telnet instead of local console. The RAW serial port is available on the first port (offset 0 from base port) and CLI is available on the second port (offset 1 from base port). By default, 4900 is the base port, therefore RAW access is available from port 4900 and CLI access is available on port 4901.</p></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:24pt" cellspacing="0"><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Command Line Option</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Optional values</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt" bgcolor="#797777"><p class="s7" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Description</p></td></tr><tr style="height:19pt"><td style="width:139pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">-x</p></td><td style="width:121pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s11" style="padding-top: 5pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">0,1</p></td><td style="width:280pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt"><p class="s8" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">Enable/disable data randomization.</p></td></tr></table><p class="s5" style="padding-bottom: 3pt;padding-left: 305pt;text-indent: 0pt;text-align: left;">Design Considerations for Host and NCP Communications</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_008.png"/></span></p><ol id="l7"><li><h3 style="padding-top: 7pt;padding-left: 42pt;text-indent: -18pt;text-align: justify;"><a name="bookmark8">Design Considerations for Host and NCP Communications</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;">Silicon Labs recommends these best practices for Host and NCP communications:</p><ul id="l8"><li><p style="padding-top: 8pt;padding-left: 36pt;text-indent: -9pt;text-align: justify;">Use a well-tuned crystal (38.4 MHz) for any wireless mesh application.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: justify;">Use of RTS/CTS hardware flow control is highly recommended. It will aid in electrically-noisy environments.</p></li><li><p style="padding-top: 3pt;padding-left: 36pt;text-indent: -9pt;text-align: justify;">UART-based NCP is not suitable for low-power designs due to the inability of the NCP to enter into any sleep modes. In designs where low power NCPs are required, Silicon Labs recommends using SPI-NCP instead. (For more information, refer to <i>AN711: SPI Host Interfacing Guide for Zigbee</i>.)</p></li><li><p style="padding-top: 2pt;padding-left: 36pt;text-indent: -9pt;text-align: justify;">Silicon Labs recommends including the nRESET and Bootload pins in all Host-NCP hardware designs as a backup for situations where serial communication are lost between the Host and NCP. For secure designs (utilizing secure EZSP) or security products, these connections should be considered mandatory.</p></li></ul><p class="s5" style="padding-bottom: 3pt;padding-left: 366pt;text-indent: 0pt;text-align: left;">Powering On, Power Cycling, and Rebooting</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_009.png"/></span></p></li><li><h3 style="padding-top: 7pt;padding-left: 42pt;text-indent: -18pt;text-align: left;"><a name="bookmark9">Powering On, Power Cycling, and Rebooting</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: justify;">When the Host powers on or reboots, it cannot guarantee that the NCP is ready to receive commands. Therefore, the Host should al- ways perform a reset of the NCP to place it into a known state. It is far simpler to reset the NCP and begin from a known state than to try to recover and resync with the previous (unknown) state of the NCP. This reset can be performed either via an ASH RST frame or toggling the nRESET line (if it is enabled). By guaranteeing that the NCP is freshly booted just like the Host, the Host can proceed with standard node and network initialization instead of consuming extra code space just trying to determine what state the NCP was left in.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: justify;">When the NCP resets, it will issue an RSTACK frame to alert the Host it has reset, which includes the reset type as defined by platform/ base/hal/micro/generic/em2xx-reset-defs.h. Once the RSTACK frame is received, the Host will know the NCP is in a known state to start operation.</p><p class="s5" style="padding-bottom: 3pt;text-indent: 0pt;text-align: right;">Bootloading</p><p style="padding-left: 24pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="713" height="0" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_010.png"/></span></p></li><li><h3 style="padding-top: 7pt;padding-left: 39pt;text-indent: -15pt;text-align: left;"><a name="bookmark10">Bootloading</a></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;">The NCP can enter bootload mode through either a software command or a hardware toggle.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><ol id="l9"><li><p class="s6" style="padding-top: 5pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark11">Software Bootloading</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">When operating in EZSP mode, issuing the bootloader frame launchStandaloneBootloader will cause the NCP to enter into the boot- loader. This can be used at any time when the Host wants to restart the NCP in the bootloader.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li><li><p class="s6" style="padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark12">Hardware Bootloading</a></p><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">Asserting the bootloader pin (low) while powering up or resetting the NCP will cause the chip to enter the bootloader instead of resum- ing normal NCP operation. In the Gecko Bootloader, a recovery pin can be defined in the board configuration to initiate bootloader mode. You define the recovery pin using the Gecko Bootloader&#39;s &quot;GPIO Activation&quot; plugin through the BTL_BUTTON settings.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">An example of performing this reset would be as follows:</p><ol id="l10"><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">Assert nRESET to hold the NCP in reset.</p></li><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">While nRESET is asserted, assert BOOTLOAD, and then deassert nRESET to boot the NCP.</p></li><li><p style="padding-top: 3pt;padding-left: 42pt;text-indent: -9pt;text-align: left;">The BOOTLOAD line can be deasserted once the reset line has been deasserted.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">For more information on using the Gecko Bootloader, see <i>UG266: Silicon Labs Gecko Bootloader User&#39;s Guide</i>.</p><p style="text-indent: 0pt;text-align: left;"><br/></p></li></ol></li><li><p class="s6" style="padding-top: 5pt;padding-left: 41pt;text-indent: -17pt;text-align: left;"><a name="bookmark13">Bootloader Operation</a></p></li></ol></li></ol><p style="padding-top: 8pt;padding-left: 23pt;text-indent: 0pt;text-align: justify;">The target device’s bootloader sends output over its serial port after it receives a carriage return from the source device at the expected baud rate. This prevents the bootloader from prematurely sending commands that might be misinterpreted by other devices that are connected to the serial port. Note that serial bootloaders typically do not enforce any timeout when awaiting the initial serial handshake via carriage return, so the bootloader will wait indefinitely in this mode until guided by the source device or until the chip is reset.</p><p style="padding-top: 8pt;padding-left: 24pt;text-indent: 0pt;text-align: left;">After the bootloader receives a carriage return from the target device, it displays a menu with the following ASCII-based output (where</p><p class="s10" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">X.Y.A <span class="p">corresponds to the major, minor, and sub-minor fields of the bootloader version number, respectively).</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">Gecko Bootloader vX.Y.A</p><ol id="l11"><li><p class="s10" style="padding-left: 17pt;text-indent: -14pt;text-align: left;">upload gbl</p></li><li><p class="s10" style="padding-left: 17pt;text-indent: -14pt;text-align: left;">Run</p></li><li><p class="s10" style="padding-left: 2pt;text-indent: 0pt;line-height: 107%;text-align: left;">ebl info BL &gt;</p></li></ol><p style="padding-left: 21pt;text-indent: 0pt;text-align: left;"/><p style="padding-top: 6pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">Once this is received, the Host can be assured that the NCP is operating in bootloader mode.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h4 style="padding-left: 17pt;text-indent: 0pt;text-align: left;">Smart. Connected. Energy-Friendly.</h4><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Products</p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.silabs.com/products">www.silabs.com/products</a></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Quality</p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.silabs.com/quality">www.silabs.com/quality</a></p><p class="s12" style="text-indent: 0pt;line-height: 9pt;text-align: center;">Support and Community</p><p class="s13" style="text-indent: 0pt;text-align: center;">community.silabs.com</p><p style="padding-left: 64pt;text-indent: 0pt;text-align: left;"><span style=" color: black; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt;">		</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="767" height="695" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_011.png"/></span></p><p class="s14" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Disclaimer</p><p class="s15" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Silicon Labs intends to provide customers with the latest, accurate, and in-depth documentation of all peripherals and modules available for system and software implementers using or intending to use the Silicon Labs products. Characterization data, available modules and peripherals, memory sizes and memory addresses refer to each specific device, and &quot;Typical&quot; parameters provided can and do vary in different applications. Application examples described herein are for illustrative purposes only. Silicon Labs reserves the right to make changes without further notice to the product information, specifications, and descriptions herein, and does not give warranties as to the accuracy or completeness of the included information. Without prior notification, Silicon Labs may update product firmware during the manufacturing process for security or reliability reasons. Such changes will not alter the specifications or the performance of the product. Silicon Labs shall have no liability for the consequences of use of the information supplied in this document. This document does not imply or expressly grant any license to design or fabricate any integrated circuits. The products are not designed or authorized to be used within any FDA Class III devices, applications for which FDA premarket approval is required, or Life Support Systems without the specific written consent of Silicon Labs. A &quot;Life Support System&quot; is any product or system intended to support or sustain life and/or health, which, if it fails, can be reasonably expected to result in significant personal injury or death. Silicon Labs products are not designed or authorized for military applications. Silicon Labs products shall under no circumstances be used in weapons of mass destruction including (but not limited to) nuclear, biological or chemical weapons, or missiles capable of delivering such weapons. Silicon Labs disclaims all express and implied warranties and shall not be responsible or liable for any injuries or damages related to use of a Silicon Labs product in such unauthorized applications.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Trademark Information</p><p class="s15" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Silicon Laboratories Inc.®, Silicon Laboratories®, Silicon Labs®, SiLabs® and the Silicon Labs logo®, Bluegiga®, Bluegiga Logo®, ClockBuilder®, CMEMS®, DSPLL®, EFM®, EFM32®, EFR, Ember®, Energy Micro, Energy Micro logo and combinations thereof, &quot;the world’s most energy friendly microcontrollers&quot;, Ember®, EZLink®, EZRadio®, EZRadioPRO®, Gecko®, Gecko OS, Gecko OS Studio, ISOmodem®, Precision32®, ProSLIC®, Simplicity Studio®, SiPHY®, Telegesis, the Telegesis Logo®, USBXpress® , Zentri, the Zentri logo and Zentri DMS, Z- Wave®, and others are trademarks or registered trademarks of Silicon Labs. ARM, CORTEX, Cortex-M3 and THUMB are trademarks or registered trademarks of ARM Holdings. Keil is a registered trademark of ARM Limited. Wi-Fi is a registered trademark of the Wi-Fi Alliance. All other products or brand names mentioned herein are trademarks of their respective holders.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="152" height="75" alt="image" src="an706-ezsp-uart-host-interfacing-guide/Image_012.png"/></span></p><p class="s14" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">Silicon Laboratories Inc. 400 West Cesar Chavez Austin, TX 78701</p><p class="s14" style="padding-left: 168pt;text-indent: 0pt;text-align: left;">USA</p><p style="padding-top: 5pt;padding-left: 168pt;text-indent: 0pt;text-align: left;"><h2 href="http://www.silabs.com/">http://www.silabs.com</h2></p></body></html>
